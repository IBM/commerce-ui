# Commerce administration console 

## Set up correct node
Considering the fact that people may work on multiple versions of node for different projects, `nvm` could be a good choice for setting up node virtual environment. [This](https://nodesource.com/blog/installing-node-js-tutorial-using-nvm-on-mac-os-x-and-ubuntu/) is a brief manual to install `nvm`.  An alternative Windows version is [here](https://github.com/coreybutler/nvm-windows/releases)

## Install dependencies
Follow the [instruction](https://yarnpkg.com/en/docs/install#mac-stable) to install *YARN*.

After *YARN* is installed, install project's dependencies.
```
yarn install
```

## Add additional dependency
```
yarn add yourDepencencyName
```
Remember to check in your `yarn.lock` and `package.json` file every time the dependencies are updated. 

## Install dependencies (alternative)
```
gradle build
```

## Install dependencies (alternative 2)
```
npm install
```

# Development server

Run `npm start` for a dev server. Navigate to `https://localhost:7443`. The app will automatically reload if you change any of the source files. This command will also load reverse proxy settings in `proxy.conf.json`.
By default the reverse proxy is configured to run with your transaction server toolkit. With the transaction server running, you can launch Management Center using `https://localhost:7443/lobtools/cmc/ManagementCenter`.

Check [proxy settings](https://github.com/angular/angular-cli/blob/master/docs/documentation/stories/proxy.md) to set up correct proxy for dev server. 

## Code scaffolding

Run `ng generate component component-name` to generate a new component. You can also use `ng generate directive|pipe|service|class|guard|interface|enum|module`.

## Internationalization
Follow Common-UI-Shell, the project use `ngx-translate` to provide internationalization related service. Available locale id are: `de, en, es, fr, it, ja, ko, pt_BR, sv, zh_TW, zh`. 

Translation file located in `src/app/i18n` serves as a global translation. Each feature should have its own translation file in their own folder.

## Generating combined REST API swagger

Install api-spec-converter using the following command: `npm install -g api-spec-converter`
Convert openApi 3.1 to swagger 2: `api-spec-converter --from=openapi_3 --to=swagger_2 ../../WebSphereCommerce/commerce-transaction-server/src/projects/Rest-Transaction/WebContent/WEB-INF/config/bod/v2/online-stores.yml > api_definition\online-stores.json`
Install swagger-combine using the following command: `npm install –g swagger-combine`
Combine swagger into one swagger file: `swagger-combine swagger-combine.json > api_definition/swagger.json`
The swagger combine depends on the transaction server swagger files found here: https://ecdgit.canlab.ibm.com/aleong-ca/commerce-api-management
Before running `npm run build-api`, you must clone commerce-api-management at the same directory level as commerce-ui.

## Create Rest service
Run `npm run build-api` to generate the REST service client.

## Kill dev server process
If you are using Mac OS, you may need run `sudo kill -9 $(sudo lsof -t -i:7443)` to kill previous `ng serve` process. 


# Folders and files
```
src
├── app
│   ├── app-routing.module.ts           // feature level routing
│   ├── app.component.html              
│   ├── app.component.scss
│   ├── app.component.spec.ts
│   ├── app.component.ts
│   ├── app.constant.ts
│   ├── app.module.ts
│   ├── components                      // add shared components here
│   ├── features       // feature a group of files supporting one single business requirement
│   │   ├── angular-pattern-1
│   │   │   ├── angular-pattern-1-routing.module.ts
│   │   │   ├── angular-pattern-1.component.html
│   │   │   ├── angular-pattern-1.component.scss
│   │   │   ├── angular-pattern-1.component.spec.ts
│   │   │   ├── angular-pattern-1.component.ts
│   │   │   ├── angular-pattern-1.module.ts
│   │   │   └── i18n
│   │   │       └── en.json                     // translate file
│   │   └── angular-pattern-2
│   │       ├── angular-pattern-2-routing.module.ts
│   │       ├── angular-pattern-2.component.html
│   │       ├── angular-pattern-2.component.scss
│   │       ├── angular-pattern-2.component.spec.ts
│   │       ├── angular-pattern-2.component.ts
│   │       ├── angular-pattern-2.module.ts
│   │       └── i18n
│   │           └── en.json
│   ├── i18n
│   │   └── en.json                         // global translate file
│   └── rest                                // autogenerated rest service
│       ├── api-configuration.ts
│       ├── api.module.ts
│       ├── base-service.ts
│       ├── models
│       │   └── org.ts                      // entity definition
│       ├── models.ts
│       └── services
│           └── orgs.service.ts             // rest service
├── assets
│   └── images
│       └── angular.svg                     // images assets
├── environments                            // Do not touch this file
│   ├── environment.prod.ts
│   └── environment.ts
├── favicon.ico
├── index.html
├── main.ts
├── polyfills.ts
├── scss                                
│   ├── _mixins.scss                        // global mixins
│   ├── _variables.scss                     // global variables, import this in your scss file
│   └── styles.scss                         // global styles
├── test.ts
├── tsconfig.app.json
├── tsconfig.spec.json
└── typings.d.ts

```



